<html>
  <head>
    <title>Die Hölle der Dr. Hÿnkell.</title>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="js/typed.js"></script>
    <script src="js/grained.min.js"></script>
    <link rel="stylesheet" type="text/css" href="css/frontpage.css">
    <script>
    	var messages = [];
    	var last_seen_id = -1;
    	var options = {
		  "animate": true,
		  "patternWidth": 482.42,
		  "patternHeight": 500,
		  "grainOpacity": 0.04,
		  "grainDensity": 1,
		  "grainWidth": 1,
		  "grainHeight": 1
		}
    </script>
    <script>
    	function incomingMessage(m){
    	
    		if(m.id > last_seen_id){
    			alert(m.id + " " + m.sender + " "+m.content);
    			messages.push(m);
	 			var new_id = newmessages[i].id;
	 			if(new_id > last_seen_id){
	 				last_seen_id = new_id;
	 			}
    		}
    	}
    </script>
    <script>
		$(window).load(function() {
			$('#console').keypress(function(e){
		    	if(e.keyCode==13){
		    		var input = $('#console').val();
		    		doCommand(input);
		    		$('#console').val("$: ");
		    	}
		    });
			//$('#consoleoutput').val('room/controle/~$');
			
			grained('#noiseoverlay', options)
			grained('#noiseoverlay2', options)
			$('#consoleoutput').typed({
        		strings: ["NIGGA I IZ FINNA KILL U.\nZUCKE ZIE ZOMBIE DICK NIGGA.\nC U IN HELL.\n"],
        		typeSpeed: 0
     		 });
			$('#clicker').click(function(){ 
   				$(function(){
   					ajax = $.getJSON( "getmessages/id=-1", function( json ) {
		  				console.log( json );
		 			});
		 			setTimeout(function(){ ajax.abort(); }, 3000);
     				navigator.vibrate = navigator.vibrate ||
                  						navigator.webkitVibrate ||
                 						navigator.mozVibrate || 
                  						navigator.msVibrate;
                  	if (navigator.vibrate) {
  						console.log('we can vibrate');
  						navigator.vibrate([5000, 300, 1000, 100, 1000, 100, 1000, 100, 1000]);
					} else {
  						console.log('no vibration for you :-(');
					}
  				});
   				$('#consoleoutput').val($('#consoleoutput').val()+'\nroom/controle/~$ Welcome to Die Hölle der Dr. Hÿnkell.\nroom/controle/~$ Good luck with surviving.'); 
			})
      		
 			setInterval(function () {
 				var uri = "getmessages/id=" + last_seen_id;
	 			ajax3 = $.getJSON( uri, function( newmessages ) {
	 				for (i = 0; i < newmessages.length; i++) { 
	 					alert(newmessages[i].sender);
	 					
	 					incomingMessage(newmessages[i]);
	 				}
	 			});
	 			setTimeout(function(){ ajax3.abort(); }, 2000);
	 		},2500);
		});
    </script>  
    <script language="javascript" type="text/javascript">

	</script> 

  </head>
  <body style=" font-size: 2em;">
	<div class="pageheader" style="width: 100%; height:2em; line-height: 2em; font-size: 3em;" id="clicker">
		Posteingang
	</div>
	<div class="spacerlvl1"></div>
	<div class="pageheader" style="width: 100%;  height:2em; line-height: 2em; vertical-align: middle; font-size: 2em;">
		Dr. Hynkëll
	</div>
 	<div class="screenwrapper" style="height: 70%; width: 100%;">
 		<div class="screencontainer">
 		<textarea id="consoleoutput" type="text" class="consoletext" name="telnum" cols="40" rows="5" value="" readonly="readonly"  style="font-size: 1em; border-radius: 0px;"/>
	    	
	    </textarea>
 		<div id="noiseoverlay" style="width:100%; height:100%; position: absolute; top: 0; left: 0;  background-color: #020501; border: 0px solid;border-radius: 15px; border-color: #32cd32 #32cd32;">	    </div>
	    </div>	 
	   
	</div>
	<div class="spacerlvl1"></div>
	<div class="pageheader" style="width: 100%;  height:2em; line-height: 2em; vertical-align: middle; font-size: 2em;">
		Back
	</div>
  </body>
</html>